{'business_flags': {'class_credit_no_future': [],
                    'future_with_zero_credit': [{'classes_remaining': 0,
                                                 'name': 'Sergey',
                                                 'student': '742242',
                                                 'upcoming_classes': 6}],
                    'premium_visibility': [{'classes_remaining': 0,
                                            'name': 'Sergey',
                                            'student': '742242',
                                            'upcoming_classes': 6}]},
 'duplicate_classes': [{'count': 2,
                        'datetime': '2025-09-24T13:00:00+07:00',
                        'name': 'Sergey',
                        'student': '742242'},
                       {'count': 2,
                        'datetime': '2025-09-29T13:00:00+07:00',
                        'name': 'Sergey',
                        'student': '742242'},
                       {'count': 2,
                        'datetime': '2025-10-01T13:00:00+07:00',
                        'name': 'Sergey',
                        'student': '742242'},
                       {'count': 2,
                        'datetime': '2025-10-09T11:00:00+07:00',
                        'name': 'Maria',
                        'student': '76032708'},
                       {'count': 2,
                        'datetime': '2025-10-16T11:00:00+07:00',
                        'name': 'Maria',
                        'student': '76032708'}],
 'invalid_students': [{'issues': ['missing telegram_id'],
                       'name': 'Filipp',
                       'student': 'aurika_flow'},
                      {'issues': ['missing telegram_id'],
                       'name': 'Jinn',
                       'student': 'jinn'}],
 'log_naive_strings': [],
 'log_parse_errors': [{'date': None,
                       'index': 100,
                       'status': None,
                       'student': '1566976731'},
                      {'date': None,
                       'index': 101,
                       'status': None,
                       'student': '1566976731'},
                      {'date': None,
                       'index': 130,
                       'status': None,
                       'student': '76032708'}],
 'log_schema_variants': [(['status', 'note', 'student', 'date'], 90),
                         (['note', 'student', 'status', 'date', 'admin'], 27),
                         (['student', 'status', 'at', 'type', 'date', 'ts'],
                          18),
                         (['status', 'student', 'ts', 'date'], 10),
                         (['student', 'new_value', 'ts', 'type'], 3)],
 'log_timezone_issues': [],
 'logs_missing_required': [{'entry': {'new_value': True,
                                      'student': '1566976731',
                                      'ts': '2025-09-07T15:43:54.890610',
                                      'type': 'pause_toggled'},
                            'index': 100,
                            'missing': ['date', 'status']},
                           {'entry': {'new_value': False,
                                      'student': '1566976731',
                                      'ts': '2025-09-07T15:43:59.486123',
                                      'type': 'pause_toggled'},
                            'index': 101,
                            'missing': ['date', 'status']},
                           {'entry': {'new_value': False,
                                      'student': '76032708',
                                      'ts': '2025-09-23T16:47:46.356446',
                                      'type': 'pause_toggled'},
                            'index': 130,
                            'missing': ['date', 'status']}],
 'meta': {'logs': 148, 'students': 12, 'today': '2025-09-25'},
 'missing_logs_count': 21,
 'missing_logs_samples': [{'date': '2025-09-24',
                           'expected': 2,
                           'logged': 0,
                           'name': 'Alexander',
                           'student': '325871233'},
                          {'date': '2025-09-25',
                           'expected': 2,
                           'logged': 0,
                           'name': 'Alexander',
                           'student': '325871233'},
                          {'date': '2025-09-22',
                           'expected': 1,
                           'logged': 0,
                           'name': 'Anna',
                           'student': '365509656'},
                          {'date': '2025-09-18',
                           'expected': 1,
                           'logged': 0,
                           'name': 'Daniel',
                           'student': '408026385'},
                          {'date': '2025-09-25',
                           'expected': 1,
                           'logged': 0,
                           'name': 'Daniel',
                           'student': '408026385'}],
 'orphan_date_logs_count': 95,
 'orphan_date_logs_global_count': 68,
 'orphan_date_logs_global_samples': [{'date': '2025-08-10',
                                      'index': 0,
                                      'raw_date': '2025-08-10',
                                      'status': 'cancel_confirmed',
                                      'student': '1566976731'},
                                     {'date': '2025-08-10',
                                      'index': 1,
                                      'raw_date': '2025-08-10',
                                      'status': 'completed',
                                      'student': '1566976731'},
                                     {'date': '2025-08-10',
                                      'index': 2,
                                      'raw_date': '2025-08-10',
                                      'status': 'cancelled (early)',
                                      'student': '1566976731'},
                                     {'date': '2025-08-10',
                                      'index': 3,
                                      'raw_date': '2025-08-10',
                                      'status': 'reschedule_requested',
                                      'student': '1566976731'},
                                     {'date': '2025-08-10',
                                      'index': 4,
                                      'raw_date': '2025-08-10',
                                      'status': 'rescheduled_to_2025-09-11 '
                                                '13:00',
                                      'student': '1566976731'}],
 'orphan_date_logs_samples': [{'date': '2025-08-10',
                               'index': 0,
                               'raw_date': '2025-08-10',
                               'status': 'cancel_confirmed',
                               'student': '1566976731'},
                              {'date': '2025-08-10',
                               'index': 1,
                               'raw_date': '2025-08-10',
                               'status': 'completed',
                               'student': '1566976731'},
                              {'date': '2025-08-10',
                               'index': 2,
                               'raw_date': '2025-08-10',
                               'status': 'cancelled (early)',
                               'student': '1566976731'},
                              {'date': '2025-08-10',
                               'index': 3,
                               'raw_date': '2025-08-10',
                               'status': 'reschedule_requested',
                               'student': '1566976731'},
                              {'date': '2025-08-10',
                               'index': 4,
                               'raw_date': '2025-08-10',
                               'status': 'rescheduled_to_2025-09-11 13:00',
                               'student': '1566976731'}],
 'orphan_student_logs_count': 20,
 'orphan_student_logs_samples': [{'date': '2025-08-18',
                                  'index': 19,
                                  'status': 'removed',
                                  'student': '1430772716'},
                                 {'date': '2025-08-20',
                                  'index': 23,
                                  'status': 'completed',
                                  'student': '1430772716'},
                                 {'date': '2025-08-22',
                                  'index': 25,
                                  'status': 'completed',
                                  'student': '1430772716'},
                                 {'date': '2025-08-22',
                                  'index': 26,
                                  'status': 'completed',
                                  'student': '1430772716'},
                                 {'date': '2025-08-22',
                                  'index': 27,
                                  'status': 'completed',
                                  'student': '1430772716'}],
 'schedule_naive_strings': [],
 'schedule_parse_errors': [],
 'schedule_timezone_issues': [],
 'student_completion_stats': [{'actual': 12,
                               'completion_rate': 1.0909090909090908,
                               'expected': 11,
                               'name': 'Yulia',
                               'student': '446785918'},
                              {'actual': 2,
                               'completion_rate': 0.4,
                               'expected': 5,
                               'name': 'Sergey',
                               'student': '742242'},
                              {'actual': 1,
                               'completion_rate': 0.3333333333333333,
                               'expected': 3,
                               'name': 'Daniel',
                               'student': '408026385'},
                              {'actual': 1,
                               'completion_rate': 0.16666666666666666,
                               'expected': 6,
                               'name': 'Zaura & Igor',
                               'student': '883527125'},
                              {'actual': 0,
                               'completion_rate': 0.0,
                               'expected': 1,
                               'name': 'Anna',
                               'student': '365509656'},
                              {'actual': 0,
                               'completion_rate': 0.0,
                               'expected': 2,
                               'name': 'Maria',
                               'student': '76032708'},
                              {'actual': 0,
                               'completion_rate': 0.0,
                               'expected': 2,
                               'name': 'Jinn',
                               'student': 'jinn'},
                              {'actual': 0,
                               'completion_rate': 0.0,
                               'expected': 4,
                               'name': 'Alexander',
                               'student': '325871233'},
                              {'actual': 0,
                               'completion_rate': 0.0,
                               'expected': 5,
                               'name': 'Filipp',
                               'student': 'aurika_flow'},
                              {'actual': 0,
                               'completion_rate': None,
                               'expected': 0,
                               'name': 'Gregor',
                               'student': '1566976731'},
                              {'actual': 0,
                               'completion_rate': None,
                               'expected': 0,
                               'name': 'Oleg',
                               'student': '468212483'},
                              {'actual': 0,
                               'completion_rate': None,
                               'expected': 0,
                               'name': 'Svetlana',
                               'student': '868930626'}],
 'student_schema_variants': [(['cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'cancelled_dates',
                               'plan_price',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              3),
                             (['cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'plan_price',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              2),
                             (['cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'cancelled_dates',
                               'plan_price',
                               'premium',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'last_balance_warning',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              1),
                             (['cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              1),
                             (['telegram_mode',
                               'cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              1),
                             (['cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'cancelled_dates',
                               'plan_price',
                               'premium',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              1),
                             (['cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'cancelled_dates',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              1),
                             (['cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'plan_price',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'needs_id',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              1),
                             (['telegram_mode',
                               'cycle_weeks',
                               'notes',
                               'classes_remaining',
                               'name',
                               'telegram_id',
                               'schedule_pattern',
                               'reschedule_credit',
                               'class_dates',
                               'paused',
                               'cutoff_hours',
                               'free_class_credit',
                               'needs_id',
                               'class_duration_hours',
                               'reminder_offset_minutes',
                               'telegram_handle'],
                              1)],
 'students_with_past_no_logs': [{'name': 'Alexander',
                                 'past_dates': ['2025-09-24', '2025-09-25'],
                                 'student': '325871233'},
                                {'name': 'Anna',
                                 'past_dates': ['2025-09-22'],
                                 'student': '365509656'},
                                {'name': 'Maria',
                                 'past_dates': ['2025-09-18', '2025-09-19'],
                                 'student': '76032708'},
                                {'name': 'Filipp',
                                 'past_dates': ['2025-09-11',
                                                '2025-09-12',
                                                '2025-09-18',
                                                '2025-09-19',
                                                '2025-09-25'],
                                 'student': 'aurika_flow'},
                                {'name': 'Jinn',
                                 'past_dates': ['2025-09-22', '2025-09-23'],
                                 'student': 'jinn'}]}
